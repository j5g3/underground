//# sourceMappingURL=underground.js.map
(function(c,a){function b(a){c.addEventListener("load",function(){new b.nc(a)})}c.n=b;b.extend=function(a,b){for(var e in b)a[e]=b[e]};b.extend(b,{i:function(a){this.extend(a)},Da:function(a){return function(b){return new a(b)}},id:function(b){return a.getElementById(b)},ready:function(a){c.addEventListener("load",a,!1)},L:function(b){return a.createElement(b)}});b.L.src=function(b,c){var e=a.createElement(b);e.setAttribute("src",c);return e};b.L.ga=function(a){return b.L.src("img",a)};b.i.extend=
function(a,c){function e(){}var g,k=this,h=a.d||function(){k.apply(this,arguments)},q;e.prototype=k.prototype;h.prototype=new e;h.extend=b.i.extend;for(g in a)a.hasOwnProperty(g)&&(q=Object.getOwnPropertyDescriptor(a,g),Object.defineProperty(h.prototype,g,q));for(g in c)c.hasOwnProperty(g)&&(q=Object.getOwnPropertyDescriptor(c,g),Object.defineProperty(h,g,q));return h};b.i.prototype.extend=function(a){for(var b in a)this[b]=a[b]}})(this,this.document);
(function(c,a,b){var d=a.L("CANVAS"),f=a.Da;a.extend(a,{ng:function(e){return Math.random()*e},Eh:function(e){return Math.random()*e|0},Bc:function(e,a,b){var d=[],c;if(a)for(;a--;)for(d[a]=[],c=0;c<e;c++)d[a][c]=b;else for(;e--;)d.push(b);return d},canvas:function(e,g){var b=a.L("CANVAS");b.setAttribute("width",e);b.setAttribute("height",g);return b},Ea:function(e){var g=typeof e;if("object"===g){if(null===e)return"null";if(e instanceof Array)return"array";if(e instanceof a.i)return"j5g3";if(e instanceof
c.HTMLElement||e instanceof c.Image)return"dom";if(e instanceof c.HTMLAudioElement)return"audio"}return g},wb:function(e,a,b,h){return d.getContext("2d").createLinearGradient(e,a,b,h)},Oh:function(e,a,k,d){d===b&&(d=1);return"rgba("+e+","+a+","+k+","+d+")"},Ch:function(e,a,k,d){d===b&&(d=1);return"hsla("+e+","+a+"%,"+k+"%,"+d+")"}});a.Na={Ub:function(){},Ce:function(e){this.ma(e);this.J(e);this.end(e)},dh:function(e){this.J(e)},Qe:function(){var e=this.ub;e.clearRect(0,0,this.width,this.height);this.ma(e);
this.J(e);this.end(e);this.screen.clearRect(0,0,this.width,this.height);this.screen.drawImage(this.ab,0,0)},Re:function(){var e=this.ub,a=this.R,b=this.ea,d=this.S,c=this.da;0!==b&&0!==c&&(e.clearRect(a,d,b,c),this.ma(e),this.J(e),this.end(e),this.screen.clearRect(a,d,b,c),this.screen.drawImage(this.ab,a,d,b,c,a,d,b,c),this.R=this.S=null,this.da=this.ea=0)},hh:function(){var e=this.ub;this.clearRect(0,0,this.canvas.width,this.canvas.height);this.ma(e);this.J(e);this.end(e)},Ug:function(e){e.drawImage(this.source,
this.x+this.c,this.y+this.a)},Pb:function(e){e.drawImage(this.$e,0,0,this.width,this.height,this.x+this.c,this.y+this.a,this.width,this.height)}};a.ia={Image:function(e){e.drawImage(this.source,this.c,this.a)},Wg:function(e){e.drawImage(this.source,this.c,this.a,this.width,this.height)},Sb:function(e){var a=this.source;e.drawImage(a.ga,a.x,a.y,a.we,a.Vd,this.c,this.a,this.width,this.height)},gb:function(e){var a=this.frame,b=a;for(e.translate(this.c,this.a);(b=b.T)!==a;)b.P(e)},Text:function(e){e.fillText(this.text,
this.c,this.a)},Oe:function(e){for(var a=this.text.split("\n"),b=0,d=a.length,c=0;b<d;b++)e.fillText(a[b],this.c,this.a+c),c+=this.Ya},kh:function(e){e.strokeText(this.text,this.c,this.a)},Ue:function(e){e.fillText(this.text,this.c,this.a);e.strokeText(this.text,this.c,this.a)},pa:function(e){var a=this.map,b=a.length,d,c=this.F,f,m;for(e.translate(this.c,this.a+b*this.za);b--;)for(d=a[b].length,m=a[b],e.translate(d*this.ca,-this.za);d--;)e.translate(-this.ca,0),(f=c[m[d]])&&f.P(e)},He:function(e){var a=
this.map,b=0,d,c=a.length,f=this.F,m;d=(this.ca/2|0)+this.offsetX;var p=(this.za/2|0)+this.offsetY,r,s;e.translate(this.c,this.a-p);for(r=d;b<c;b++)for(d=a[b].length,m=a[b],r=-r,e.translate(d*this.ca-r,p);d--;)e.translate(-this.ca,0),(s=f[m[d]])&&s.P(e)}};a.Pb={Be:function(e,b){var d=a.L("CANVAS"),h;d.width=e||this.width;d.height=b||this.height;h=d.getContext("2d");h.translate(-this.x-this.c,-this.y-this.a);this.Kf();this.P(h);this.$e=d;this.xd=this.P;this.P=a.Na.Pb;return this},Fg:function(e,
a){return e(a,d.getContext("2d"))}};a.Oa={Ub:function(){return!1},fb:function(e,a,b){b=b?b.product(this.k,this.x,this.y):this.k.Ib(this.x,this.y);b.Zc(e,a);return b.x*b.x+b.y*b.y<=this.g*this.g?this:!1},gb:function(e,a,b){var d=this.frame,c=d,f;for(b=b?b.product(this.k,this.x,this.y):this.k.Ib(this.x,this.y);(c=c.Y)!==d&&!(f=c.Ba(e,a,b)););return f},Rect:function(a,b,d){d=d?d.product(this.k,this.x,this.y):this.k.Ib(this.x,this.y);d.Zc(a,b);return 0<d.x&&d.x<this.width&&0<d.y&&d.y<this.height?this:
!1},Rb:function(a,b,d){var c=this.Ha,f=this.Oc,l=0,m=c.length;d=d?d.product(this.k,this.x,this.y):this.k.Ib(this.x,this.y);for(d.Zc(a,b);l<m;l+=2)if(a=f[l]*(d.x-c[l])+f[l+1]*(d.y-c[l+1]),0<a)return!1;return this}};a.Me=a.i.extend({o:1,p:0,q:0,s:1,rc:1,xc:0,Ia:1,Db:1,d:function(a,g,d,c){a!==b&&(this.o=a,this.p=g,this.q=d,this.s=c)},rg:function(a){this.rc=Math.cos(a);this.xc=Math.sin(a);return this.$b()},sg:function(a){this.Ia=a;return this.$b()},tg:function(a){this.Db=a;return this.$b()},scale:function(a,
b){this.Ia=a;this.Db=b;return this.$b()},$b:function(){this.o=this.Ia*this.rc;this.p=this.Ia*this.xc;this.q=-this.Db*this.xc;this.s=this.Db*this.rc;return this},Ib:function(e,b){return new a.gd(this.o,this.p,this.q,this.s,e||0,b||0)}});a.gd=a.i.extend({o:1,p:0,q:0,s:1,G:0,A:0,d:function(a,g,d,c,f,l){a!==b&&(this.o=a,this.p=g,this.q=d,this.s=c,this.G=f,this.A=l)},translate:function(a,b){this.G+=a;this.A+=b},multiply:function(a,b,d,c,f,l){var m=this.o,p=this.p,r=this.q,s=this.s;this.o=m*a+r*b;this.p=
p*a+s*b;this.q=m*d+r*c;this.s=p*d+s*c;this.G+=m*f+r*l;this.A+=p*f+s*l;return this},clone:function(){return a.ag().multiply(this.o,this.p,this.q,this.s,this.G,this.A)},inverse:function(){var a=this.clone(),b=this.o*this.s-this.p*this.q;a.o=this.s/b;a.p=this.p/-b;a.q=this.q/-b;a.s=this.o/b;a.G=(this.s*this.G-this.q*this.A)/-b;a.A=(this.p*this.G-this.o*this.A)/b;return a},product:function(a,b,d){return this.clone().multiply(a.o,a.p,a.q,a.s,a.G||b||0,a.A||d||0)},reset:function(){this.o=1;this.q=this.p=
0;this.s=1;this.A=this.G=0;return this},ai:function(a,b){this.x=this.o*a+this.q*b+this.G;this.y=this.p*a+this.s*b+this.A;return this},Zc:function(a,b){var d=this.o*this.s-this.p*this.q;this.x=(this.s*a-this.q*b+this.q*this.A-this.s*this.G)/d;this.y=(-this.p*a+this.o*b+this.p*this.G-this.o*this.A)/d;return this}});a.j=a.i.extend({source:null,T:null,Y:null,parent:null,k:null,x:0,y:0,c:0,a:0,width:null,height:null,Cd:0,set rotation(a){this.k.rg(this.Cd=a)},get rotation(){return this.Cd},set La(a){this.k.sg(a)},
get La(){return this.k.Ia},set Ma(a){this.k.tg(a)},get Ma(){return this.k.Db},alpha:1,Fd:null,stroke:null,fill:null,font:null,yb:null,Lc:null,Mc:null,ce:null,uh:!0,d:function(e){this.k=new a.Me;this.extend(e)},ma:function(a){var b=this.k;a.save();1!==this.alpha&&(a.globalAlpha*=this.alpha);null!==this.fill&&(a.fillStyle=this.fill);null!==this.stroke&&(a.strokeStyle=this.stroke);null!==this.font&&(a.font=this.font);null!==this.Fd&&(a.globalCompositeOperation=this.Fd);null!==this.yb&&(a.lineWidth=this.yb);
null!==this.Lc&&(a.lineCap=this.Lc);null!==this.Mc&&(a.lineJoin=this.Mc);null!==this.ce&&(a.miterLimit=this.ce);a.transform(b.o,b.p,b.q,b.s,this.x,this.y)},end:function(a){a.restore()},P:a.Na.Ce,tc:null,Ga:function(){this.parent.Ga(this)},update:null,remove:function(){this.parent&&(this.Y.T=this.T,this.T.Y=this.Y,this.parent=this.Y=null);return this},align:function(a,b){b=b||this.parent;switch(a){case "center":this.x=b.width/2;break;case "left":this.x=0;break;case "right":this.x=b.width-this.width;
break;case "middle":this.y=b.height/2;break;case "center middle":this.u(b.width/2,b.height/2);break;case "origin":this.u(-this.width/2,-this.height/2);break;case "origin top":this.u(-this.width/2,-this.height);break;case "origin bottom":this.u(-this.width/2,0)}return this},u:function(a,b){this.x=a;this.y=b;return this},size:function(a,b){this.width=a;this.height=b;return this},move:function(a,b){this.x+=a;this.y+=b;return this},visible:function(){return 0<this.alpha},stretch:function(a,b){return this.scale(a/
this.width,b/this.height)},$h:function(){return a.clip({width:this.width,height:this.height}).add(this)},Hf:a.Pb.Be,Kf:function(){this.xd&&(this.P=this.xd)},set:function(a){this.extend(a);return this},Ba:a.Oa.Rect,scale:function(a,d){d===b&&(d=a);c.isNaN(a)||(this.La=a);c.isNaN(d)||(this.Ma=d);return this},rotate:function(a){this.rotation+=a;return this}});a.Image=a.j.extend({d:function(e){switch(a.Ea(e)){case "string":e={source:a.id(e)};break;case "dom":e={source:e}}a.j.call(this,e);this.source&&
this.vg(this.source)},J:a.ia.Image,gf:function(e){return"string"===typeof e?a.id(e):e},vg:function(a){this.source=this.gf(a);null===this.width&&(this.width=this.source.naturalWidth||this.source.width);null===this.height&&(this.height=this.source.naturalHeight||this.source.height)}});a.Text=a.j.extend({text:"",Ya:null,lh:null,nb:function(a){var b=this.be();"left"===a?this.c=0:"center"===a?this.c=-b/2:"right"===a&&(this.c=-b);return this},d:function(e){"string"===typeof e&&(e={text:e});a.j.call(this,
e);null===this.Ya&&this.be()},tc:a.ia.Text,J:a.ia.Text,rf:function(e,b){var d=(""+e.text).split("\n"),c,f=d.length,l=0;a:{c=e;do{if(null!==c.font){c=c.font;break a}if(c instanceof a.Tb)break}while(c=c.parent);c=void 0}e.ma(b);c&&(b.font=c);for(;f--;)c=b.measureText(d[f]),c.width>l&&(l=c.width);null===e.Ya&&(e.Ya=parseInt(b.font,10));e.end(b);return l},pc:a.j.prototype.ma,ma:function(a){a.textBaseline="top";this.pc(a)},be:function(){return a.Pb.Fg(this.rf,this)}});a.Ge=a.j.extend({Wd:"",d:function(e){"string"===
typeof e&&(e={Wd:a.L(e).innerHTML});a.j.apply(this,[e])}});a.D=a.j.extend({ka:null,Sa:0,length:null,jc:!0,se:1,mb:function(e){a.j.call(this,e);this.ka=[];this.qa()},d:function(a){this.mb(a);null!==this.N&&this.N()},Ga:function(a){this.parent.Ga(a||this)},N:null,update:function(){var a=this.frame,b=a;for(this.Mb&&this.Mb();(b=b.T)!==a;)null!==b.update&&b.update();this.jc&&((this.Sa+=this.se)>=this.length&&(this.Sa=0),this.frame=this.ka[this.Sa|0])},frame:null,J:a.ia.gb,stop:function(){this.jc=!1;return this},
play:function(){this.jc=!0;return this},add:function(e){switch(a.Ea(e)){case "function":e=new a.bd(e);break;case "string":e=new a.Image({source:e});break;case "array":for(var b=0;b<e.length;b++)this.add(e[b]);return this;case "dom":case "object":e=new a.Image(e);break;case "undefined":case "null":throw"Trying to add undefined object to clip.";}return this.Wb(e)},Wb:function(a){var b=this.frame;a.parent&&a.remove();b.Y.T=a;a.Y=b.Y;a.T=b;a.parent=this;b.Y=a;return this},qa:function(a){var b={};b.Y=
b.T=b;this.ka.push(b);this.go((this.length=this.ka.length)-1);return a?this.add(a):this},Gh:function(){return this.frame.T===this.frame},me:function(a){a=a===b?this.Sa:a;this.ka.splice(a,1);this.go(0<a?a-1:0);this.length=this.ka.length;return this},go:function(a){this.frame=this.ka[this.Sa=a];return this},Xa:function(a){for(var b=this.ka.length,d,c;b--;)for(c=d=this.ka[b];(c=c.T)!==d;)a(c);return this},wh:function(a){for(var b=this.frame,d=b,c;(d=c=d.T)!==b;)for(;(c=c.T)!==b;)a(d,c)},mh:function(a){return this.Xa(function(b){b.align&&
b.align(a)})},Ba:a.Oa.gb});a.Tb=a.D.extend({canvas:null,ub:null,screen:null,ab:null,Sh:!1,background:!1,U:!1,R:0,S:0,ea:0,da:0,kf:function(){if(!1===this.U)return this.U=c.document.body;if("dom"===a.Ea(this.U))return this.U;var b=this.U=a.L("DIV");b.className="j5g3-stage";c.document.body.appendChild(b);return b},jf:function(){var b=this.kf();this.canvas||(this.canvas=a.canvas(this.width,this.height),this.background?b.insertBefore(this.canvas,b.firstChild):b.appendChild(this.canvas));this.ab=a.L("CANVAS")},
lf:function(){this.ub=this.ab.getContext("2d");this.screen=this.canvas.getContext("2d")},d:function(b){a.D.call(this,b);this.jf();this.pg(this.width||this.canvas.clientWidth||640,this.height||this.canvas.clientHeight||480);this.lf()},Wf:function(b){var d;"string"===typeof b&&(b={canvas:a.id(b)});a.extend(d={width:this.width,height:this.height,U:this.U},b);b=new a.Tb(d);b.P=a.Na.Re;this.add(b);return b},Ga:function(a){if(a===b)this.R=this.S=0,this.da=this.height,this.ea=this.width;else{var d=a.x+a.c,
c=a.y+a.a;null===this.R?this.R=d:d<this.R&&(this.ea+=this.R-d,this.R=d);null===this.S&&(this.S=c);c<this.S&&(this.da+=this.S-c,this.S=c);d+a.width>this.R+this.ea&&(this.ea=d+a.width-this.R,this.R+this.ea>this.width&&(this.ea=this.width-this.R));c+a.height>this.S+this.da&&(this.da=c+a.height-this.S,this.S+this.da>this.height&&(this.da=this.height-this.S))}},pg:function(a,b){if(0===a||0===b)throw Error("Invalid stage resolution: "+a+"x"+b);this.ea=this.canvas.width=this.ab.width=a;this.da=this.canvas.height=
this.ab.height=b;return this.size(a,b)},P:a.Na.Qe});a.Ra=a.j.extend({la:!1,repeat:Infinity,duration:100,H:null,target:null,O:null,Hb:0,he:null,W:null,d:function(b){b instanceof a.i&&(b={target:b});this.update=this.start;a.j.apply(this,[b]);this.target&&this.H&&this.target.set(this.H)},P:a.Na.Ub,pause:function(){this.yd=this.update;this.update=null;return this},qg:function(){this.update=this.yd?this.yd:this.start;return this},ne:function(){this.repeat-=1;this.Nb=this.Hb=0;return this},Vc:function(){this.Hb=
0;return this.stop().start()},stop:function(){this.pause().ne();this.he&&this.he();return this},Nf:function(a){return a},Dd:function(a,b){return this.H[a]+this.Nf(b)*(this.O[a]-this.H[a])},vc:a.j.prototype.remove,remove:function(){this.W&&this.W();this.vc()},af:function(){var a=this.target,b;this.duration===this.Hb&&(this.Nb=1);for(b in this.O)a[b]=this.Dd(b,this.Nb);this.Hb<this.duration?(this.Hb++,this.Nb+=this.Gg):this.la?this.remove():this.repeat?this.ne():this.stop()},start:function(){var a=
this.O,b,d=this.target;if(null===this.H)for(b in this.H={},a)this.H[b]=d[b];this.Gg=1/this.duration;this.Nb=0;this.update=this.af;this.update();return this},Ba:a.Oa.Ub});a.Sb=a.j.extend({d:function(b){a.j.call(this,b);if(!this.source)throw Error("Invalid source property for Sprite");null===this.width&&(this.width=this.source.we);null===this.height&&(this.height=this.source.Vd)},J:a.ia.Sb});a.Te=a.i.extend({width:null,height:null,Vb:null,d:function(b){switch(a.Ea(b)){case "string":case "dom":case "j5g3":b=
{source:b}}a.i.call(this,b)},set source(b){switch(a.Ea(b)){case "string":case "dom":b=new a.Image(b);break}if(!b)throw Error("Invalid source for Spritesheet.");null===this.width&&b&&(this.width=b.width);null===this.height&&b&&(this.height=b.height);this.uf=b;this.Vb=[]},get source(){return this.uf},select:function(a){var b=[];this.Xa(a,function(a){b.push(a)});return b},Xa:function(a,b){for(var d=0,c=a.length;d<c;d++)b(this.v(a[d]));return this},clip:function(b){var d=a.clip().me(),c=0,f=0;this.Xa(b,
function(a){d.qa(a);a.width>c&&(c=a.width);a.height>f&&(f=a.height)});return d.size(c,f).go(0)},push:function(a,b,d,c){this.slice(a,b,d,c);return this},slice:function(a,b,d,c){return this.Vb.push({width:d,height:c,source:{ga:this.source.source,x:a,y:b,we:d,Vd:c}})-1},ph:function(a,b,d,c){return this.v(this.slice(a,b,d,c))},Td:function(a,b,d){d=d||0;var c=2*d,f=this.width/a-c|0,l=this.height/b-c|0,m,p;for(m=0;m<b;m++)for(p=0;p<a;p++)this.slice(p*(f+c)+d,m*(l+c)+d,f,l);return this},v:function(b){return new a.Sb(this.Vb[b])},
F:function(){for(var a=0,b=this.Vb.length,d=[];a<b;a++)d.push(this.v(a));return d},map:function(b,d){return new a.pa({F:this.F(),ca:b,za:d})}});a.Fe=a.D.extend({d:function(b){a.D.apply(this,[b])},source:a.D,Lf:function(){this.pf--?null!==this.od&&this.od():this.remove()},Yf:10,ge:null,count:1,Bg:function(){var a=new this.source;a.pf=this.Yf;a.od=a.update;a.update=this.Lf;return a},df:function(){var a=this.Bg();this.Wb(a);this.ge&&this.ge(a)},Mb:function(){for(var a=this.count;a--;)this.df()}});a.pa=
a.j.extend({F:null,map:null,ca:0,za:0,offsetX:0,offsetY:0,d:function(b){a.j.apply(this,[b]);null===this.map&&(this.map=[])},te:function(a,b){var d=(this.ca/2|0)+this.offsetX;return{x:(a*this.ca-(b%2?0:-d)|0)-this.c,y:(b*((this.za/2|0)+this.offsetY)|0)-this.a}},J:a.ia.pa});a.bd=a.i.extend({mb:a.i,update:null,P:a.Na.Ub,d:function(b){"function"===a.Ea(b)&&(b={update:b});this.mb(b)},remove:a.j.prototype.remove},{rotate:function(a){return function(){a.rotation=6.1>a.rotation?a.rotation+.1:0}}});a.nc=a.i.extend({version:"0.9.0",
oc:31,wc:null,pd:null,Bd:0,qd:0,paused:!0,oe:function(){var a=this;a.Kd();a.wc=function(){a.Ad()};a.Ad();a.pd=function(){a.ff()};a.qd=c.setInterval(a.pd,a.oc);a.paused=!1;return a},Kd:function(){c.clearInterval(this.qd);c.cancelAnimationFrame(this.Bd)},bc:function(){this.pause();this.eg&&this.eg()},Ad:function(){this.h.P();this.Bd=c.requestAnimationFrame(this.wc)},ff:function(){this.h.update()},Xc:function(){},d:function(e){"function"===typeof e&&(e={Xc:e});e===b&&(e={});d.style.display="none";d.setAttribute("id",
"j5g3-cache");c.document.body.appendChild(d);a.i.apply(this,[e]);this.Fb||(this.Fb={});this.Fb.canvas||(this.Fb.canvas=a.id("screen"));this.h||(this.h=new a.Tb(this.Fb));this.Xc(a,this)},pause:function(){this.Kd();this.wc=function(){};this.paused=!0},qg:function(){this.paused&&this.oe()},set Pf(a){this.oc=1E3/a},get Pf(){return 1E3/this.oc},Dh:function(b,c){var f,h;switch(a.Ea(b)){case "string":f=a.id(b);break;case "dom":f=b;break;case "j5g3":f=b.source}return f?(d.width=f.width,d.height=f.height,
h=d.getContext("2d"),h.drawImage(f,0,0),h.getImageData(0,0,f.width,f.height)):this.h.ub.createImageData(b||this.h.canvas.width,c||this.h.canvas.height)}});a.Sg=function(){function a(b,d){c["EaseIn"+b]=d;c["EaseOut"+b]=function(a){return 1-d(1-a)};c["EaseInOut"+b]=function(a){return.5>a?d(2*a)/2:d(-2*a+2)/-2+1}}var b={},d,c={};["Quad","Cubic","Quart","Quint","Expo"].forEach(function(a,d){b[a]=function(a){return Math.pow(a,d+2)}});b.ih=function(a){return 1-Math.cos(a*Math.PI/2)};b.Pg=function(a){return 1-
Math.sqrt(1-a*a)};b.Tg=function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)};b.Kg=function(a){return a*a*(3*a-2)};b.Ng=function(a){for(var b,d=4;a<((b=Math.pow(2,--d))-1)/11;);return 1/Math.pow(4,3-d)-7.5625*Math.pow((3*b-2)/22-a,2)};for(d in b)a(d,b[d]);c.Zg=function(a){return a};c.jh=function(a){return-Math.cos(a*Math.PI)/2+.5};return c}();a.action=f(a.bd);a.clip=f(a.D);a.ga=f(a.Image);a.v=f(a.Sb);a.B=f(a.Te);a.text=f(a.Text);a.h=f(a.Tb);a.Kh=function(b){b=
new a.Text(b);b.J=a.ia.Oe;return b};a.Ja=function(b){b=new a.Text(b);b.J=a.ia.Ue;return b};a.ag=function(){return new a.gd(void 0,void 0,void 0,void 0,void 0,void 0)};a.K=f(a.Ra);a.xh=f(a.Fe);a.map=f(a.pa);a.Wd=f(a.Ge);a.yh=f(a.nc)})(this,this.n);
(function(c,a){a.Ke=a.i.extend({Ee:{IMG:"load",AUDIO:"canplaythrough",SCRIPT:"load"},ya:null,Mf:250,ke:0,start:null,length:0,Cb:null,hc:null,Tc:null,d:function(b){a.i.apply(this,[b]);this.ya={};this.start=new Date},ld:function(){var a,d=0,f=0,e=this;for(a in this.ya)f++,this.ya.hasOwnProperty(a)&&this.ya[a].ready&&d++;this.ke=d?d/f:0;this.Cb&&this.Cb(this.ke);f===d?this.Tc&&this.Tc():this.vf=c.setTimeout(function(){e.ld()},this.Mf)},na:function(b,d){var f=this,e=this.ya[d],g;e?e=e.na:(e=a.L(b),this.ya[d]=
g={na:e},e.addEventListener(this.Ee[b],function(){g.ready=!0;f.hc&&f.hc(g)},!1),e.addEventListener("error",function(){g.ready=!0;c.console.warn("Could not load asset: "+d)},!1),e.setAttribute("src",d),this.length++);return e},Q:function(a){return this.na("IMG",a)},audio:function(b){var d=b.split(".").pop();a.Gb.audio[d]||(b=b.replace(new RegExp("\\."+d+"$"),"."+a.Gb.audio.lg));return this.na("AUDIO",b)},data:function(a,d){var f=this,e=new c.XMLHttpRequest,g=this.ya[a];g||(g=this.ya[a]={source:a,Nh:e},
e.onreadystatechange=function(){4===e.readyState&&(g.ready=!0,g.og=e.responseText,d&&d(g),f.hc&&f.hc(e))},e.open("GET",a),e.send());return g},ec:function(a){return this.data(a,function(a){a.ec=JSON.parse(a.og)})},Ph:function(a){a=this.na("SCRIPT",a);c.document.head.appendChild(a);return a},ready:function(a){a&&(this.Tc=a);this.ld()},bc:function(){c.clearTimeout(this.vf)}});a.Za=a.Da(a.Ke)})(this,this.n);
(function(c){c.Qb=c.i.extend({ze:null,cd:null,Pc:0,Qc:0,Uc:0,length:0,Kb:0,Lb:0,0:null,1:null,2:null,3:null,4:null,5:null,6:null,le:null});c.Qb.fb=c.Qb.extend({le:function(a,b){var d=a.g+b.g,c=a.x+a.g+a.c,e=a.y+a.g+a.a,g=c-b.g-b.c-b.x,k=e-b.g-b.a-b.y,h=g*g+k*k;if(this.Wa=d*d>h)return h=Math.sqrt(h),this.ze=a,this.cd=b,this.Pc=g/h,this.Qc=k/h,this.Uc=d-h,this[0]=c-g/2,this[1]=e-k/2,!0}});c.Qb.ad=c.Qb.extend({le:function(a,b){var d=a.x+a.c,c=b.x+b.c,e=a.y+a.a,g=b.y+b.a,k=d+a.width,h=c+b.width,q=e+a.height,
l=g+b.height,m,p;if(this.Wa=!(c>=k||h<=d||g>=q||l<=e))return this.cd=b,m=this.Kb=h/2-k/2,p=this.Lb=l/2-q/2,this[0]=Math.max(d,c),this[1]=Math.max(e,g),this[2]=Math.min(k,h),this[3]=Math.min(q,l),this[2]-this[0]<this[3]-this[1]?(this.Pc=0>m?-1:1,this.Qc=0,this.Uc=0>m?this[2]-d:k-this[0]):(this.Qc=0>p?-1:1,this.Pc=0,this.Uc=0>p?this[3]-e:q-this[1]),this}});c.dd={fb:function(a){var b=this.g+a.g,d=this.x+this.g+this.c-a.g-a.c-a.x;a=this.y+this.g+this.a-a.g-a.a-a.y;return b*b>d*d+a*a},ad:function(a){var b=
this.y+this.height,d=a.x+a.width,c=a.y+a.height;return!(a.x>this.x+this.width||d<this.x||a.y>b||c<this.y)},gb:function(a){var b=this.frame,d=b,c=!1;for(a={x:a.x-this.x,y:a.y-this.y,width:a.width,height:a.height};(d=d.Y)!==b&&!(c=d.Wa&&d.Wa(a)););return c}};c.j.prototype.Wa=c.dd.ad;c.D.prototype.Wa=c.dd.gb})(this.n);
(function(c,a){c.ja=c.j.extend({shape:null,red:a,green:a,blue:a,Ld:"fill",uc:a,rd:a,kd:a,yb:null,d:function(a){c.j.apply(this,[a])},pc:c.j.prototype.ma,ma:function(a){if(this.red!==this.uc||this.blue!==this.kd||this.green!==this.rd)this[this.Ld]="rgb("+Math.floor(this.red)+","+Math.floor(this.green)+","+Math.floor(this.blue)+")",this.uc=this.uc,this.rd=this.green,this.kd=this.blue;this.pc(a)},ic:function(){},J:function(a){a.beginPath();this.ic(a);a.closePath();a.fill();a.stroke()}});c.fb=c.ja.extend({shape:"circle",
g:0,d:function(a){"number"===typeof a&&(a={g:a});c.ja.apply(this,[a])},ic:function(a){a.arc(this.g+this.c,this.g+this.a,this.g,0,2*Math.PI,!1)},Ba:c.Oa.fb});c.Ie=c.ja.extend({Hg:0,Ig:0,ic:function(a){a.moveTo(this.c,this.a);a.lineTo(this.Hg,this.Ig)}});c.Rb=c.ja.extend({shape:"polygon",Ha:null,Oc:null,d:function(a){c.ja.apply(this,[a]);null===this.Ha&&(this.Ha=[]);null===this.Oc&&this.If()},normalize:function(a){var d=Math.sqrt(a[0]*a[0]+a[1]*a[1]);a[0]/=d;a[1]/=d;return a},If:function(){for(var a=
0,d,c=this.Ha,e=c.length,g=[],k=[0,0];a<e;a+=2)d=a+2<e?a+2:0,k[0]=c[d]-c[a],k[1]=c[d+1]-c[a+1],this.normalize(k),g.push(k[1],-k[0]);this.Oc=g},ic:function(a){var d=2,c=this.Ha,e=c.length;for(a.moveTo(c[0],c[1]);d<e;d+=2)a.lineTo(c[d],c[d+1])},Ba:c.Oa.Rb},{create:function(a,d){var f=2*Math.PI/a,e=f;for(d.Ha=[];a--;)d.Ha.push(Math.cos(e)*d.g,Math.sin(e)*d.g),e+=f;return new c.Rb(d)}});c.Rect=c.ja.extend({shape:"polygon",d:function(a){c.ja.apply(this,[a]);null===this.width&&(this.height=this.width=2*
this.g)},J:function(a){a.fillRect(this.c,this.a,this.width,this.height);a.strokeRect(this.c,this.a,this.width,this.height)}});c.De=c.ja.extend({shape:"circle",Lc:"round",Mc:"round",Ld:"stroke",d:function(a){"number"===typeof a&&(a={yb:a});c.ja.apply(this,[a])},J:function(a){a.strokeRect(0,0,1,1)}});c.Mh=c.Da(c.Rb);c.oh=c.Da(c.fb);c.Jh=c.Da(c.Ie);c.vh=c.Da(c.De);c.rect=c.Da(c.Rect)})(this.n);
(function(c,a){var b=a.L("audio"),d=["wav","mp3","ogg"],f=["audio/wav","audio/mpeg","audio/ogg"];Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a,arguments)}});c.HTMLAudioElement||(c.HTMLAudioElement=c.Jg);c.requestAnimationFrame||(c.requestAnimationFrame=c.mozRequestAnimationFrame||c.msRequestAnimationFrame||function(a){return c.setTimeout(a,1E3/60)});c.cancelAnimationFrame||(c.cancelAnimationFrame=c.mozCancelAnimationFrame||c.msCancelAnimationFrame||
function(a){c.clearTimeout(a)});a.Gb={audio:{},$c:"ontouchstart"in c.document};b&&b.canPlayType&&d.forEach(function(d,c){a.Gb.audio[d]=b.canPlayType(f[c]);a.Gb.audio[d]&&(a.Gb.audio.lg=d)})})(this,this.n);(function(c,a){var b=a.navigator.Fh;c.m=function(a){return new c.m.Je(a)};c.m.Qa={};c.m.ed=function(a,b){this.f=a;c.extend(this,b)};c.m.ed.prototype={f:null,remove:function(){this.f.Eg(this)}};c.m.Je=c.i.extend({x:0,y:0,Od:0,Pd:0,Yb:0,Zb:0,La:1,Ma:1,V:null,element:null,interval:60,Rf:null,sa:null,Ef:!0,gc:!1,disabled:!1,d:function(d){var f=this;if("string"===typeof d||"object"===typeof d&&d.tagName)d={element:d};c.i.call(this,d);null===this.element?this.element=a.document:"string"===typeof this.element&&
(this.element=c.id(this.element));f.V={};f.sa=[];f.je=function(){f.tf()};f.sb=function(a){f.bf(a)};b||(a.addEventListener("resize",this.sb),a.addEventListener("scroll",this.sb),this.sb());this.Rf=a.setInterval(this.je,this.interval);for(var e in c.m.Qa)f.V[e]=new c.m.Qa[e](f)},Wh:function(b){var c=this;c.disabled=!0;a.setTimeout(function(){c.disabled=!1},b)},fe:function(a){a=new c.m.ed(this,a);this.sa.push(a);return a},Eg:function(a){this.sa.splice(this.sa.indexOf(a),1)},Z:function(a,b){if(!this.disabled&&
(b.Hh=this,b.name=a,(!this.Rc||!1!==this.Rc(b))&&this.sa))for(var c=this.sa.length,g;c--;)if(g=this.sa[c][a])if(b.preventDefault(),!1===g(b))break},bf:function(){var b=this.element,c;b.getBoundingClientRect?(c=b.getBoundingClientRect(),this.Yb=a.scrollX+(c.left|0)||0,this.Zb=a.scrollY+(c.top|0)||0):(this.Yb=b.clientLeft||0,this.Zb=b.clientTop||0);this.Ef&&b.width&&b.height&&(this.La=b.width/b.clientWidth,this.Ma=b.height/b.clientHeight)},tf:function(){if(!1===this.disabled)for(var a in this.V)this.V[a].update()},
qe:function(a,b){a=(a-this.Yb)*this.La;b=(b-this.Zb)*this.Ma;this.Od=a-this.x;this.Pd=b-this.y;this.x=a;this.y=b},bc:function(){this.disable();this.sa=null;a.removeEventListener("scroll",this.sb);a.removeEventListener("resize",this.sb);a.clearInterval(this.je)},enable:function(){this.disabled=!1;for(var a in this.V)this.V[a].enable()},disable:function(){this.disabled=!0;for(var a in this.V)this.V[a].disable()}});c.m.Pa=c.i.extend({M:null,na:null,enabled:!1,kb:null,jb:null,d:function(a){this.M={};
this.f=a;this.na=a.element;this.enable();a.gc&&this.ud()},ud:function(){this.gc=!0},update:function(){},Ta:function(a,b){var c=b.bind(this);this.M[a]=c;this.na.addEventListener(a,c)},Ua:function(a){this.na.removeEventListener(a,this.M[a])},enable:function(){this.enabled||(this.kb(),this.enabled=!0);return this},disable:function(){this.enabled&&(this.jb(),this.enabled=!1);return this},bc:function(){this.disable();for(var a in this.f.V)if(this.f.V[a]===this){delete this.f.V[a];break}}})})(this.n,this);
(function(c){c.m.Qa.Ne=c.m.Pa.extend({cb:1,eb:1,Yb:0,Zb:0,Dc:!0,ib:function(a){this.f.qe(a.pageX,a.pageY)},md:function(a){var b={0:"buttonY",1:"buttonX",2:"buttonA"}[a.button];this.ib(a);this.f.Z(b,a);this.f.Z("button",a);return!1},ud:function(){this.Dc=!1},sf:function(a){this.Dc&&(this.ib(a),(Math.abs(this.f.Od)>this.cb||Math.abs(this.f.Pd)>this.eb)&&this.f.Z("move",a))},kb:function(){this.Ta("mousemove",this.sf);this.Ta("click",this.md);this.Ta("contextmenu",this.md)},jb:function(){this.Ua("mousemove");
this.Ua("click");this.Ua("contextmenu")}})})(this.n,this);
(function(c){c.m.Qa.Touch=c.m.Pa.extend({cb:20,eb:20,cc:70,Of:200,fg:null,gg:null,touches:null,sc:"linear",set Nc(a){this.sc=a;this.jd="linear"===a?this.Xe:this.Ye},get Nc(){return this.sc},g:25,Xb:0,jd:null,d:function(a){c.m.Pa.call(this,a);this.Nc=this.sc},ib:function(a){this.f.qe(a.pageX,a.pageY)},Ec:function(a,b){for(var d=a.changedTouches,c=d.length,e;c--;)e=d[c].identifier,e=this.touches[e]||(this.touches[e]={id:e}),e.Ca=a,e.$c=d[c],this.ib(e.$c),b(e,this)},update:function(){if(!this.gc){var a=
this.touches,b,d;for(d in a)b=a[d],b.bg||(this.ib(b.$c),this.f.Z("buttonY",b.Ca))}},Md:function(a){a.bg=!0;this.f.Z(a.direction,a.Ca);this.gc||(a.Ca.direction=a.direction,this.f.Z("move",a.Ca))},Xe:function(a,b){var d=b.f.x,c=b.f.y,e=d-a.ua,g=c-a.va,k;e<-b.cb?(a.ua=d,k="left"):e>b.cb&&(a.ua=d,k="right");g<-b.eb?(a.va=c,k="up"+(k?"_"+k:"")):g>b.eb&&(a.va=c,k="down"+(k?"_"+k:""));(a.direction=k)&&b.Md(a)},Ye:function(a,b){var d=b.f.x,c=b.f.y,e=a.Kb-d,g=a.Lb-c,d=d-a.hg,c=c-a.ig;(e>b.cb||e<-b.cb)&&(g>
b.eb||g<-b.eb)&&(b.Xb=a.Ca.Xb=Math.atan2(c,d),b.f.Z("move",a.Ca))},xf:function(a){this.Ec(a,this.jd)},ef:function(a){var b=this.f.x-a.Kb,d=this.f.y-a.Lb,c;b<-this.cc?c="buttonY":b>this.cc&&(c="buttonA");d<-this.cc?c="buttonX":d>this.cc&&(c="buttonB");c?this.f.Z(c,a.Ca):a.direction&&this.Md(a)},ug:function(a){a.hg=this.fg||a.Kb-Math.cos(this.Xb)*this.g;a.ig=this.gg||a.Lb-Math.sin(this.Xb)*this.g},Ze:function(a,b){a.start=Date.now();a.Kb=a.ua=b.f.x;a.Lb=a.va=b.f.y;"radial"===b.Nc&&b.ug(a)},We:function(a,
b){Date.now()-a.start<b.Of&&b.ef(a);delete b.touches[a.id]},yf:function(a){this.Ec(a,this.Ze)},wf:function(a){this.Ec(a,this.We)},kb:function(){this.Ta("touchmove",this.xf);this.Ta("touchstart",this.yf);this.Ta("touchend",this.wf);this.touches={}},jb:function(){this.Ua("touchmove");this.Ua("touchstart");this.Ua("touchend")}})})(this.n,this);
(function(c,a){var b=a.document,d={32:"buttonB",13:"buttonY",16:"buttonX",17:"buttonA",37:"left",38:"up",39:"right",40:"down",105:"up_right",103:"up_left",99:"down_right",97:"down_left"};c.m.Qa.Yg=c.m.Pa.extend({xb:null,keys:null,nf:function(a){this.keys[a.keyCode]=a;this.xb[a.keyCode]&&a.preventDefault()},d:function(a){this.keys={};c.m.Pa.call(this,a);null===this.xb&&c.extend(this.xb={},d)},of:function(a){this.keys[a.keyCode]=!1},update:function(){var a,b,c;for(c in this.xb)if(b=this.keys[c])a=this.xb[c],
this.f.Z(a,b),32<c&&(b.direction=a,this.f.Z("move",b)),this.f.Z("button",b)},kb:function(){this.keys={};this.M.Yd=this.nf.bind(this);this.M.Zd=this.of.bind(this);b.addEventListener("keydown",this.M.Yd);b.addEventListener("keyup",this.M.Zd)},jb:function(){this.keys={};b.removeEventListener("keydown",this.M.Yd);b.removeEventListener("keyup",this.M.Zd)}})})(this.n,this);(function(c,a){a.navigator.bi&&(c.m.Qa.Xg=c.m.Pa.extend({kb:function(){},jb:function(){}}))})(this.n,this);(function(c){c.ra={gh:{th:c.L.ga("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAPxJREFUeNqckzEKwjAUhlPB6hm8QUd1EbpVRHAS0eO0N3DuIVx0EaSoHbtoR2/gFVorGv/oSwnRIfHBlwba/Pnf63sO53zDGLuCNdgxs/DAAvQZBCL+iQfIwRL4gGl4IAQpKOlM7IgXUMpBS7nhDs4gARUIwAC0lW+eYCLVU24fwi1rkNqe2cfhvSr5FRa3V7JOapGOFgKZPNf4smQWidyoAq6FQPVLYGQhENQ7ysWnwphGQYWvHcxA08KBaKi5mkLwRx8MxSJaeYznVqtHCTL6My7Vp6e5vIGuyD+mvEpq6VDmp+HToOU0eCIih8b5BFbgYmhfuJ6CzkuAAQBw8IUZ2uqgnAAAAABJRU5ErkJggg=="),
Vh:c.L.ga("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAO5JREFUeNpi/P//PwMeEA3EL4B4Ly4FjAQM2APEH4E4GKcKkAE4sD0Q/wXi30BshEsdEx7b04AYJM8CxDmkukANiL/+R4DPQKyCTS0oDJKA5kgBsTgSlodiZPAIiB8C8WsgfgnEr4D4KcgUbyB+/Z908AKInWBOMQXiOyRovgXE+uAYRPKPIhCfIULzKSCWg+lDDxRhIL6LR/NDIBbEF42fgVgIT9SKgiIOWQDdAEsgFsBjACcQW+AzwADNNZ1A3AjE75DEDfElpPnQ5Lscmphg4rJAPAeIfwHxKmQ96AYsBGJnPPkDFN0LkMUAAgwAJMvR40MRRPUAAAAASUVORK5CYII=")},eh:{Rg:function(){}},
Mg:{Vg:function(){}},Text:{bh:function(a){var b=this.stroke||this.fill||a.fillStyle,c=this.yb||a.lineWidth;a.strokeStyle=b;a.globalAlpha=.2;a.lineWidth=c+10;a.strokeText(this.text,this.c,this.a);a.globalAlpha=.4;a.lineWidth=c+5;a.strokeText(this.text,this.c,this.a);a.globalAlpha=1;a.lineWidth=c;a.strokeText(this.text,this.c,this.a);a.globalCompositeOperation="lighter";a.fillStyle=b;a.fillText(this.text,this.c,this.a)},$g:function(a){this.tc(a);a.scale(1,-1);var b=this.a;this.a-=2*this.Ya;this.wb||
(this.wb=a.createLinearGradient(-this.c,this.a,-this.c,this.a+this.Ya),this.wb.addColorStop(1,this.fill||a.fillStyle),this.wb.addColorStop(0,"transparent"));a.fillStyle=this.wb;this.tc(a);this.a=b}},oa:{Ag:function(a){a=c.ra.oa.re(a);var b=a.O;a.O=a.H;a.H=b;return a},re:function(a){return new c.Ra({target:a,duration:30,la:!0,O:{y:a.y},H:{y:a.parent?a.parent.height:a.y+a.height}})},Fc:function(a){return new c.Ra({target:a,duration:30,la:!0,H:{alpha:0},O:{alpha:1}})},Rd:function(a){return new c.Ra({target:a,
la:!0,duration:30,O:{alpha:0}})},expand:function(a,b){b=b||1.5;return new c.Ra({target:a,la:!0,duration:30,O:{La:a.La+b,Ma:a.Ma+b}})},Rh:function(a){a=new c.Ra({target:a,g:3,duration:10,la:!0,O:{x:a.x,y:a.y}});a.Dd=function(a,d){return 1===d?this.O[a]:this.H[a]-this.g+c.ng(2*this.g)};return a}}}})(this.n);/*

 j5g3 GDK 0.1 - Game Development Kit
 http://j5g3.com

 Copyright 2010-2012, Giancarlo F Bellido

 j5g3 is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 j5g3 is distributed in the hope that it will be useful
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with j5g3. If not, see <http://www.gnu.org/licenses/>.

 Date: @DATE

*/
(function(c,a){var b=a.e={version:.1};b.Og=a.i.extend({target:null,parent:null,Xh:0,Yh:0,update:function(){}});b.Aa=a.D.extend({bb:null,Jb:null,K:null,vc:a.D.prototype.remove,W:null,Qd:function(){this.bb&&(this.add(this.K=this.bb(this)),this.K.H&&this.set(this.K.H))},nd:function(){this.vc();this.W&&this.W()},remove:function(){this.K&&this.K.remove();this.Jb?(this.add(this.K=this.Jb(this)),this.K.W=this.nd.bind(this),this.K.H&&this.set(this.K.H)):this.nd()},d:function(a){this.mb(a);this.Qd();this.N&&
this.N()}});a.e.Element=a.D.extend({zc:null,yc:null,B:null,direction:null,state:null,d:function(a){this.zc={};this.yc={};this.mb(a);this.N&&this.N();this.stop()},Th:function(b){var c=this.yc,e;for(e in b)b.hasOwnProperty(e)&&(c[e]="string"===typeof b[e]?a.id(b[e]):b[e]);return this},Ka:function(a){var b,c=0,g=this.B;this.me();for(b in a)a.hasOwnProperty(b)&&(this.zc[b]=c++,this.qa(g.clip(a[b])));return this},kg:function(a){(a=this.yc[a])&&!a.jc&&a.play()},Fa:function(a){this.kg(a);return this.state===
a?this:this.go(this.zc[this.state=a])}});a.e.ah={fh:{Ih:function(a,b,c){return function(){this.Kc<a&&(this.Kc+=1,this.Lh.zh(0,b));this.Fa(c)}},xe:function(a,b,c){return function(){this.Ia=Math.abs(this.Ia)*a;this.x+=b;c&&0===this.Kc&&this.Fa(c)}},state:function(a){return function(){this.Fa(a)}}}};a.e.Lg=a.j.extend({ta:null,set x(a){for(var b=this.ta.length;b--;)this.ta[b].x=a*this.ta[b].A;return this.k.G=a},get x(){return this.k.G},set y(a){for(var b=this.ta.length;b--;)this.ta[b].x=a*this.ta[b].A;
return this.k.A=a},get y(){return this.k.A},J:function(a){for(var b=this.ta.length;b--;)this.ta[b].P(a)},d:function(b){a.j.apply(this,[b])}})})(this,this.n);(function(c,a){a.mc=c.D.extend({input:null,Ed:!1,Gc:0,Ud:0,hb:0,qc:0,Cc:null,transform:null,Cf:function(a){a.u(this.hb,this.qc);this.hb+=this.Gc;this.hb>this.width-this.Gc&&(this.hb=0,this.qc+=this.Ud)},Wb:function(a){this.Ed&&this.Cf(a);c.D.prototype.Wb.call(this,a)},enable:function(){if(!this.input)throw Error("input property not set.");this.M||(this.M=this.input.fe({move:this.Sc.bind(this),buttonY:this.wa.bind(this)}))},disable:function(){this.M&&(this.M.remove(),this.M=null)},Mb:function(){this.enable();
this.Mb=null},find:function(){return this.Ba(this.input.x,this.input.y,this.transform)},Sc:function(){var a=this.find();this.Ac!==a&&(this.Ac&&this.Ac.go("normal"),a&&(this.Ac=a,a.go("hover")));return!0!==this.Cc},wa:function(){var a=this.find();a&&a.wa&&a.wa();return!0!==this.Cc}});a.Ob=c.D.extend({Ka:null,Yc:null,value:null,wa:null,Ba:c.Oa.Rect,go:function(a){"string"===typeof a&&(a=this.Yc[a]||0);return c.D.prototype.go.call(this,a)},hf:function(){var a=this.Ka;this.wd=c.clip();this.sd=c.clip();
this.Yc={normal:0};a&&a.Bb&&this.wd.add(a.Bb);this.add(this.wd);a&&a.Hc&&(this.Yc.hover=1,this.sd.add(a.Hc),this.qa(this.sd))},d:function(a){c.D.call(this,a);this.hf();this.go(0).stop()}})})(this.n,this.n.e);(function(c,a){var b=c.Qg;a.e=a.e||{};a.e.hd=function(a){b||(this.h=a,this.mf(),this.align())};a.e.hd.prototype={mf:function(){this.fc=a.L("DIV");this.fc.className="j5g3-stage-full";this.h.U.parentNode.appendChild(this.fc);this.fc.appendChild(this.h.U);c.addEventListener("resize",this.align.bind(this))},align:function(){var a=this.h.canvas,b=this.h.U,c=this.fc,g=c.clientHeight,c=c.clientWidth,a=a.width/a.height,k=g*a,h=g;k>c&&(k=c,h=c/a);b.style.width=Math.floor(k)+"px";b.style.height=Math.floor(h)+
"px";b.style.top=Math.floor((g-h)/2)+"px";b.style.left=Math.floor((c-k)/2)+"px"}}})(this,this.n);/*

 j5g3 GDK v@VERSION - Game Development Kit
 http://j5g3.com

 Copyright 2010-2012, Giancarlo F Bellido

 j5g3 is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 j5g3 is distributed in the hope that it will be useful
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with j5g3. If not, see <http://www.gnu.org/licenses/>.

 Date: @DATE

*/
(function(c){c.e=c.e||{};c.e.fd=c.pa.extend({I:null,qf:0,td:0,d:function(a){c.pa.apply(this,[a]);this.I&&this.transform()},lc:function(a,b,c){var f=this.I[b][a];this.I[b][a]=this.map[this.ve(a,b)][this.ue(a,b)]=c;return f},dc:function(a,b){return this.I[b][a]},transform:function(a){a=a||this.I;var b=this.qf=a[0].length,d=a.length,f=this.td=d&1?d:d-1,e=this.map=c.Bc(0,b+d-1),g=0,k=0;for(this.I=a;d--;)for(b=0;b<a[d].length;b++)g=f-d+b>>1,g>k&&(k=g),e[b+d][g]=a[d][b];a=this.te(k+1,e.length+1);this.size(a.x,
a.y);return this},ue:function(a,b){return this.td-b+a>>1},ve:function(a,b){return a+b},Zh:function(a,b){return this.map[b/(this.za/2+this.offsetY)|0][a/(this.ca/2+this.offsetX)|0]},J:c.ia.He})})(this.n);(function(c,a){a.Le=a.Aa.extend({$a:c.L.ga("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACyCAMAAACX4sbwAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAABhQTFRF9/f37u7u9PT0/v7+4+Pj+/v7////////gYJgMwAAAAh0Uk5T/////////wDeg71ZAAAEEklEQVR42uzb7VIbMQwFUFOo7vu/cWdapiRrfdkrycrA/iMk4YzslWWtGWhy0b/r86fRCvUfNpqhPmGjHeqvazRUdWARdx1nEX+NlqrDrMdx68O6JKsmrIuqHWt2jkaqXiy0YlEfFmfAaRY/j06zhAE7zCKTdSBvybngJItasrTMyVLH8RRF3EujUkXqa9VFs8ri4zfySSpLwI+qQPEIKaSjEDUndJxgkcVi35m92SeNha8fufccY+nzbxSqyD8DR6GK/EHNYr33ZL1tj2Fmlh89WV9/gC8VmMRawHqAELulZ0r8BiwurT688T2Hxfdh+GDxJXNL1lsKS2hasWPIsj7KWa60mhItqZfmZ/2KZF0hIstMq7+rWb5sH5m3rpOJ3eI8+kpYHx6WNsdSWDStISpL7SLFsebFBtLUsnevYSzyseaQSr2SEakiZQxJG+kUFjlZ/mBFsIhjcS0Qf7ACWJQQrPssmmdPFUteMa7dA4vlbVmOlZy0rML1MaYzWA6Wsp2atlukzHiFNe+OxkJOMlXaGMr1KrdnGws5yVTtsbgN7j5LU5HWo5SfUMPLErfq7DbeUJGWUZ7/wnB3g2wVFoOltCi2WGSotljYYtmxggGAyoKf5QoWFllwqNws4x50sJaaqjdZWuYlNwtLLPs2VF+2x1pebG+xsMWCo3M5NjK88I1y2nSGe5Xlq3T8LHXT757y2GF5msy3WOjGWqoL5SV4XfXNWFTAEm5vPwsJLCnrXO918bBmCot0ljhuqSwlyUOPUCJLXXugBugJGsoyFjRLlRUti0XeYIWyjOXfVN0Zw30WHWdhg4UkFt1lUSlrPVh9WFq0z7Fuq0SWb3sgZ8981sIWlS2ZA1lmsBi9tO0pZEFkeTeoZayHMvYQy5iClMTyBsvDQjLra0UxblgqZF1ntbKeZ7GkRixcvZfbFfMyy1X9PLMQxpLa1juqXBZ1Y62OIRWyzAeK0y78nopj3RpDasxCAkuqnlxjeC0QkcR6Dpb0OCN6DNdYxlPNOVhxLG0MjSfTcWO4xKJWLPPsxVyN3VWxc0s4dVUYLKuCgOPUHyQWKljkvA8jxjCAJTbkkMmyZlZssbzPEvZA9x+orLDOBGuXlbM79JaB4lmwleMRdSyzIYdUltBFM3u9qGc5WtAoYMkdU+FzQAqLnCzhgyhhiT1S7tt+IeiyBlFseyP1sqIlsXCUJT0kQEsWzrJyUngOC0dYxoFA4DRr/gWqrgVW5fV6LPywXpVFP6yXZ1FLVhPVhUU/LD+LWrKoJYtasqglq5WqO4tasiKOsMazqCUr5gjrN2EFHWENZkUdYS1g4ThL/S/yFqw2KoyWwXopFlqxqDcLjVhtahqJhZYstGCho2pioQsLDVVP9VYfFf4IMACQm8FBYS9cMwAAAABJRU5ErkJggg=="),
fa:c.rect({fill:"transparent",stroke:"#fff",width:100,height:20}),fill:c.rect({width:0,height:20,fill:"#eee"}),text:c.text({font:"10px sans-serif",fill:"#eee"}),Za:null,Df:!0,Cb:function(a){this.text.text=(100*a|0)+"%";this.text.nb("center");this.fill.width=this.fa.width*a;this.Ga()},update:function(){this.Df&&this.align("center middle");this.Za&&(this.Za.Cb=this.Cb.bind(this),this.Za.ready(this.remove.bind(this)));this.update=null},d:function(b){a.Aa.call(this,b);this.fa.u((this.$a.width-this.fa.width)/
2+2,this.$a.height+20);this.fill.u(this.fa.x,this.fa.y);this.text.u(this.$a.width/2,this.fa.y+this.fa.height+8);this.size(Math.max(this.$a.width,this.fa.width),this.$a.height+40+this.fa.height).add([this.$a,this.fill,this.fa,this.text]);this.c=-this.width/2;this.a=-this.height/2}})})(this.n,this.n.e);(function(c){var a=c.n,b=a.Za(),d=c.Se=a.nc.extend({Fb:{width:1280,height:720,U:!0},ha:null,background:null,kc:function(b,c){var d={width:h.h.width,height:h.h.height};a.extend(d,c);this.ha&&this.ha.bc();this.ha=a.m(this.h.canvas);this.h.add(new b(d))},vb:function(a,b,c){var d=this.cf||(this.cf=new k);d.parent||this.h.add(d.show(a,b,c))},Xc:function(){new a.e.hd(this.h);this.background=this.h.Wf({background:!0});this.oe()}}),f=a.e.Aa.extend({alpha:0,fill:"#eee",bb:a.ra.oa.Fc,Jb:a.ra.oa.Rd,W:function(){h.ha.Rc=
null;h.kc(e)},N:function(){d.B=a.B(d.X.Dg).Td(8,10);h.ha.Rc=this.remove.bind(this);h.ha.V.Ne.Dc=!1;this.background=a.ga(d.X.background);this.background.alpha=.5;this.add([this.background,a.Ja({x:40,y:380,font:'120px "Audiowide"',text:"Underground"}),a.Ja({x:40,y:580,font:'40px "Audiowide"',text:"Press any key to continue."})])}}),e=a.e.Aa.extend({alpha:0,bb:a.ra.oa.Fc,fill:"#eee",Eb:function(b,c){var e=this,k=d.B.v(17).scale(.8),f=d.B.v(18).scale(.8),q=a.text({text:"0"+c,x:50,y:30,font:"30px Audiowide"}).nb("center"),
t=a.text({text:"0"+c,x:50,y:30,font:"30px Audiowide"}).nb("center");this.buttons.add(new a.e.Ob({width:100,height:100,value:c,Ka:{Bb:[k,q],Hc:[f,t]},wa:function(){e.remove();h.kc(g,{ac:this.value})}}))},Wc:function(){var b=d.X.$d.ec;this.buttons=new a.e.mc({x:140,y:200,width:1100,height:600,input:h.ha,Ed:!0,Gc:150,Ud:130});b.forEach(this.Eb.bind(this));this.add(this.buttons)},wg:function(){h.background.add(a.ga(d.X.background));h.background.Ga()},N:function(){var b=a.Ja({x:320,y:60,text:"Select Destination",
font:"60px 'Audiowide'"});this.Wc();this.wg();this.add(b)}}),g=a.e.Aa.extend({ac:0,alpha:0,bb:a.ra.oa.Fc,Jb:a.ra.oa.Rd,history:null,C:null,Vc:function(a){a&&(this.ac=a);this.history=[];this.C.load(d.X.$d.ec[this.ac]);this.Hd(this.C.xa.aa,this.C.xa.ba,!0)},Jd:function(){var a=!0;this.C.pb.forEach(function(b){b.jg||(a=!1)});a&&h.vb("SUCCESS","Go back to main menu?",this.Nd.bind(this))},Sc:function(a){a={up_left:"nw",up_right:"ne",down_left:"sw",down_right:"se"}[a.direction];var b=this.C.xa;(a=a?b.move(a,
this.Hd.bind(this),this.Jd.bind(this)):!1)&&this.history.push(a)},Hd:function(b,c,d){var e=this.C;c=e.w.te(e.w.ue(b,c),e.w.ve(b,c));b=(h.h.width-e.width)/2-c.x/25|0;c=(h.h.height-e.height)/2-c.y/25|0;d?e.u(b,c):this.add(a.K({target:this.C,W:this.Jd.bind(this),la:!0,duration:10,O:{x:b,y:c}}))},reset:function(){h.vb("Reset","Restart to original position?",this.Vc.bind(this))},undo:function(){var a=this.history.pop(),b=this.C.xa;a&&(b.zb(a.Ic,a.Jc),b.direction=a.dg,b.Xd(),a.current&&a.current.zb(a.qb.Ic,
a.qb.Jc))},Nd:function(){this.remove();h.kc(e)},quit:function(){h.vb("Quit","Are you sure you want to quit?",this.Nd.bind(this))},Eb:function(b){return new a.e.Ob({width:80,height:80,Ka:{Bb:a.ga(d.X["b"+b]),Hc:a.ga(d.X["r"+b])},wa:this[b].bind(this)})},xg:function(){var b=new a.e.mc({input:h.ha});b.add([this.Eb("reset").u(30,10),this.Eb("undo").u(130,10),this.Eb("quit").u(1160,10)]);return b},N:function(){var b=this,c=this.xg(),e=a.Ja({y:0,x:480,fill:"#eee",text:"0"+this.ac,font:"80px 'Audiowide', sans-serif"}),
g=a.Ja({y:40,x:640,fill:"#eee",text:"bay",font:"40px 'Audiowide', sans-serif"});b.add([b.C=new d.Ve,c,e,g]);h.background.Ga();h.ha.fe({move:this.Sc.bind(this)});setTimeout(function(){b.Vc()},0)}});a.D.extend({fill:"white",font:"12px Arial",N:function(){var b=this.time=a.text("Time: 0").u(20,80);this.add([this.Xf=a.text("Level: ").u(20,20),this.cg=a.text("Moves: 0").u(20,40),this.mg=a.text("Pushes: 0").u(20,60),b]);this.reset()},reset:function(){this.vd=this.zd=0;this.zf(0);this.Af(0)},zf:function(a){this.cg.text=
"Moves: "+(this.vd+=a)},Af:function(a){this.mg.text="Pushes: "+(this.zd+=a)},Qh:function(a){this.Xf.text="Level: "+a}});var k=a.e.Aa.extend({x:340,y:326,width:600,height:394,bb:a.ra.oa.re,Jb:a.ra.oa.Ag,fill:"#eee",show:function(a,b,c,d){var e=this;e.title.text=a;e.title.nb("center");e.message.text=b;e.message.nb("center");e.ye.wa=function(){e.remove(c)};e.ee.wa=function(){e.remove(d)};this.Va.disable();this.Va.input=h.ha;this.Va.enable();this.K.parent||(this.y=326,this.Qd());this.K.duration=15;return this},
remove:function(b){this.W=b;this.Va.disable();a.e.Aa.prototype.remove.call(this);this.K.duration=15},Wc:function(){this.Va=new a.e.mc({transform:this.k.Ib(this.x,326),Cc:!0});this.ye=new a.e.Ob({x:150,y:230,width:80,height:80,Ka:{Bb:d.X.Gf}});this.ee=new a.e.Ob({x:370,y:230,width:80,height:80,Ka:{Bb:d.X.Ff}});this.Va.add([this.ye,this.ee])},N:function(){this.title=a.Ja({alpha:.8,x:300,y:40,font:"70px Audiowide"});this.message=a.Ja({alpha:.8,x:300,y:140,font:"26px Audiowide"});this.Wc();this.add([d.X.vb,
this.title,this.message,this.Va])}}),h,q=new a.e.Le({Za:b,W:function(){h.kc(f)}});d.X={Dg:b.Q("spritesheet.png"),Cg:b.Q("spritesheet-player.png"),Uh:b.Q("splash.png"),background:b.Q("background.jpg"),rundo:b.Q("rundo.png"),rquit:b.Q("rback.png"),rreset:b.Q("rreset.png"),bundo:b.Q("bundo.png"),bquit:b.Q("bback.png"),breset:b.Q("breset.png"),Gf:b.Q("byes.png"),Ff:b.Q("bno.png"),vb:b.Q("dialog.png"),$d:b.ec("levels.json")};h=c.Qf=new d;h.h.add(q)})(this);(function(c){var a=c.n,b=c.Se,d=c.Qf,f=[0,23],e={0:71," ":33,"@":54,"+":34,".":32,$:33,"*":33,l:11,r:10,lr:10,lt:7,lrt:3,rt:6,lb:8,lrb:1,rb:5,tb:9,t:12,b:9,lrtb:0,rtb:2,ltb:4,desk:14,"!":40,"~":41};b.Ae=a.e.Element.extend({aa:null,ba:null,C:null,v:null,N:function(){var c=a.clip().add(b.B.v(25)).qa(b.B.v(26)).qa(b.B.v(27)).qa(b.B.v(26)).go(0);c.se=.1;this.add(b.B.v(24));this.qa(c);this.Id()},Id:function(){this.go(this.jg=this.C.Uf(this.aa,this.ba)?1:0)},zb:function(a,b){var c=this.C.w;c.lc(this.aa,
this.ba,void 0);c.lc(a,b,this.v);this.aa=a;this.ba=b;this.u(0,0);this.Id()},Bf:function(){this.zb(this.Ab.x,this.Ab.y)},push:function(b){this.Ab=b;d.h.add(a.K({target:this,O:{x:b.ua,y:b.va},la:!0,duration:10,W:this.Bf.bind(this)}))}});b.Pe=a.e.Element.extend({c:20,a:70,C:null,aa:null,ba:null,zb:function(a,b){this.C.w.lc(this.aa,this.ba,void 0);this.C.w.lc(a,b,54);this.aa=a;this.ba=b},ie:function(){this.zb(this.Ab.x,this.Ab.y);this.Fa("idle_"+this.direction);this.de=!1;this.x=this.y=0},xe:function(a){this.ob(a.ua,
a.va,"walk_"+this.direction,10,this.ie)},push:function(a,b){this.ob(this.x+a.ua/2,this.y+a.va/2,"walk_"+this.direction,5,function(){this.ob(this.x,this.y,"push_"+this.direction,5,function(){a.current.push(a.qb);this.ob(this.x,this.y,"push_"+this.direction,5,function(){this.ob(this.x+a.ua/2,this.y+a.va/2,"walk_"+this.direction,5,function(){this.ie();b&&b()})})})})},move:function(a,b,c){if(!this.de){var d=this.Jf(a);d.dg=this.direction;this.direction=a;if(d)return this.Ab=d,d.Ic=this.aa,d.Jc=this.ba,
d.action.call(this,d,c),b&&b(d.x,d.y),d;this.Xd()}},Xd:function(){this.Fa("idle_"+this.direction)},ob:function(b,c,e,f,l){var m=this;m.de=!0;m.Fa(e);d.h.add(a.K({target:m,O:{x:b,y:c},la:!0,duration:f||10,W:function(){l&&l.apply(m)}}))},Sd:function(a,b,c){var d=b||this.aa,e=c||this.ba,f=64,p=48;switch(a){case "ne":e--;p*=-1;break;case "nw":d--;f*=-1;p*=-1;break;case "se":d++;break;case "sw":e++,f*=-1}return{Ic:b,Jc:c,x:d,y:e,ua:f,va:p}},Jf:function(a){var b=this.C,c=this.Sd(a),d;if(b.Vf(c.x,c.y))return!1;
if(d=b.Sf(c.x,c.y))if(c.current=d,c.qb=this.Sd(a,c.x,c.y),b.Tf(c.qb.x,c.qb.y))c.action=this.push;else return!1;else c.action=this.xe;return c},N:function(){this.B=a.B(b.X.Cg).Td(13,10);this.direction="ne";this.Ka({idle_ne:[65],idle_se:[91],idle_sw:[78],idle_nw:[52],push_ne:[65,66,67,68,69,70,71,72,73,74,75,76,77],push_nw:[52,53,54,55,56,57,58,59,60,61,62,63,64],push_se:[91,92,93,94,95,96,97,98,99,100,101,102,103],push_sw:[78,79,80,81,82,83,84,85,86,87,88,89,90],walk_ne:[13,14,15,16,17,18,19],walk_nw:[0,
1,2,3,4,5,6,7],walk_se:[39,40,41,42,43,44,45],walk_sw:[26,27,28,29,30,31,32]}).Fa("idle_ne")}});b.pa=a.i.extend({data:null,rows:null,cols:null,d:function(b){a.i.apply(this,[b]);this.normalize()},normalize:function(){var a=this.data.split("\n"),b=a.length,c=0;null===this.rows&&(this.rows=b);for(;b--;)a[b].length>c&&(c=a[b].length);this.cols=c;for(b=0;b<this.rows;b++)a[b].length<c&&(a[b]+=Array(c-a[b].length+1).join(" "));this.data=a.join("\n")},Xa:function(a){for(var b=0,c=this.data,d=c.length,e=0,
f=0;b<d;b++)"\n"===c[b]?(e++,f=0):a(c[b],f++,e,b)}});b.Ve=a.D.extend({xa:null,data:null,w:null,floor:null,pb:null,Vf:function(a,b){var c=this.w.dc(a,b);return c>f[0]&&c<f[1]},Sf:function(a,b){var c=this.w.dc(a,b);return c>=this.Gd&&this.w.F[c]},Tf:function(a,b){return!this.w.dc(a,b)},Uf:function(a,b){return 32===this.floor.dc(a,b)},pe:function(a,b,c){var d=this.xa;d.aa=a;d.ba=b;this.w.I[b][a]=54;this.floor.I[b][a]=c},Zf:function(a,b,c,d){switch(a){case "#":return this.$f(b,c,d);case "+":return this.pe(b,
c,32);case "@":return this.pe(b,c,33);case "$":return this.ae(b,c,33);case "*":return this.ae(b,c,32);case ".":this.floor.I[c][b]=32;break;case "!":break;default:this.floor.I[c][b]=33}},ae:function(a,c,d){this.floor.I[c][a]=d;d=new b.Ae({aa:a,ba:c,C:this});d.v=this.w.F.push(d)-1;this.pb.push(d);this.Gd||(this.Gd=d.v);this.w.I[c][a]=d.v},$f:function(a,b,c){var d=this.map.data;c=("#"===d[c-1]?"l":"")+("#"===d[c+1]?"r":"")+("#"===d[c-this.map.cols-1]?"t":"")+("#"===d[c+this.map.cols+1]?"b":"");""===
c&&(c="desk");this.w.I[b][a]=e[c];this.floor.I[b][a]=33},Mb:function(){this.pb&&(this.xa.update(),this.pb.forEach(function(a){a.update()}))},load:function(c){c=this.map=new b.pa(c);this.pb=[];this.w.I=a.Bc(c.cols,c.rows);this.floor.I=a.Bc(c.cols,c.rows);c.Xa(this.Zf.bind(this));this.w.transform();this.floor.transform();this.size(this.floor.width,this.floor.height);this.floor.Hf()},yg:function(){b.B.v(33);var c=this.floor=new a.e.fd({ca:128,za:192,offsetY:-48,F:{}});c.F[32]=b.B.v(32);c.F[33]=b.B.v(33)},
zg:function(){var c=this.w=new a.e.fd({ca:128,za:192,offsetY:-48,F:b.B.F()});c.F[54]=this.xa;c.F[33]=c.F[32]=c.F[71]=null},N:function(){this.xa=new b.Pe({C:this});this.zg();this.yg();this.add([this.floor,this.w])},qh:function(b,c,d){c=this.map.Bh(c,d);d=a.e.nh.B.F;c=this.w.Ah(c.x,c.y);this.rh.add(a.clip([[d[b]]]).u(c.x,c.y));this.sh.add(a.clip([[d[b+8]]]).u(c.x,c.y));return" "}})})(this);
